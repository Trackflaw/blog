<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>How to Hack a 20 billion euro multinational corporation (legally)? - Trackflaw | Cybersecurity expert</title><meta name="Description" content="Canon, a 20 billion euro multinational corporation, is impacted by 2 critical vulnerabilities that, under certain conditions, can compromise the infrastructure hosting the vulnerable application. Trackflaw shares its discovery and responsible disclosure process."><meta property="og:url" content="https://trackflaw.com/en/multinational-hacking-with-file-upload-and-ssrf/">
  <meta property="og:site_name" content="Trackflaw | Cybersecurity expert">
  <meta property="og:title" content="How to Hack a 20 billion euro multinational corporation (legally)?">
  <meta property="og:description" content="Canon, a 20 billion euro multinational corporation, is impacted by 2 critical vulnerabilities that, under certain conditions, can compromise the infrastructure hosting the vulnerable application. Trackflaw shares its discovery and responsible disclosure process.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-02T06:13:21+01:00">
    <meta property="article:modified_time" content="2024-02-02T06:13:21+01:00">
    <meta property="article:tag" content="Penetration Testing">
    <meta property="article:tag" content="Pentest">
    <meta property="article:tag" content="CVE">
    <meta property="og:image" content="https://trackflaw.com/images/hacker-multinationale-via-file-upload-et-ssrf/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://trackflaw.com/images/hacker-multinationale-via-file-upload-et-ssrf/logo.png">
  <meta name="twitter:title" content="How to Hack a 20 billion euro multinational corporation (legally)?">
  <meta name="twitter:description" content="Canon, a 20 billion euro multinational corporation, is impacted by 2 critical vulnerabilities that, under certain conditions, can compromise the infrastructure hosting the vulnerable application. Trackflaw shares its discovery and responsible disclosure process.">
      <meta name="twitter:site" content="@trackflaw">
<meta name="application-name" content="Trackflaw | Expert en sécurité offensive">
<meta name="apple-mobile-web-app-title" content="Trackflaw | Expert en sécurité offensive"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://trackflaw.com/en/multinational-hacking-with-file-upload-and-ssrf/" /><link rel="prev" href="https://trackflaw.com/en/compromise-jenkins-reading-files-cve-2024-23897/" /><link rel="next" href="https://trackflaw.com/en/ghostrace-new-concern-cpu-vulnerability/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "How to Hack a 20 billion euro multinational corporation (legally)?",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/trackflaw.com\/en\/multinational-hacking-with-file-upload-and-ssrf\/"
        },"image": ["https:\/\/trackflaw.com\/images\/logo.png"],"genre": "posts","keywords": "Penetration Testing, Pentest, CVE","wordcount":  1903 ,
        "url": "https:\/\/trackflaw.com\/en\/multinational-hacking-with-file-upload-and-ssrf\/","datePublished": "2024-02-02T06:13:21+01:00","dateModified": "2024-02-02T06:13:21+01:00","publisher": {
            "@type": "Organization",
            "name": "Thibaud Robin - Trackflaw","logo": "https:\/\/trackflaw.com\/images\/logo.png"},"author": {
                "@type": "Person",
                "name": "Author"
            },"description": "Canon, a 20 billion euro multinational corporation, is impacted by 2 critical vulnerabilities that, under certain conditions, can compromise the infrastructure hosting the vulnerable application. Trackflaw shares its discovery and responsible disclosure process."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/en/" title="Trackflaw | Cybersecurity expert"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo3.png"
        data-srcset="/images/logo3.png, /images/logo3.png 1.5x, /images/logo3.png 2x"
        data-sizes="auto"
        alt="/images/logo3.png"
        title="/images/logo3.png" />TRACKFLAW</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/en/posts/" title="Posts"> Posts </a><a class="menu-item" href="/en/news/" title="News"> News </a><a class="menu-item" href="/en/about/" title="About"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/en/multinational-hacking-with-file-upload-and-ssrf/" selected>English</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/en/" title="Trackflaw | Cybersecurity expert"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo3.png"
        data-srcset="/images/logo3.png, /images/logo3.png 1.5x, /images/logo3.png 2x"
        data-sizes="auto"
        alt="/images/logo3.png"
        title="/images/logo3.png" />TRACKFLAW</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/en/posts/" title="Posts">Posts</a><a class="menu-item" href="/en/news/" title="News">News</a><a class="menu-item" href="/en/about/" title="About">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/en/multinational-hacking-with-file-upload-and-ssrf/" selected>English</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">How to Hack a 20 billion euro multinational corporation (legally)?</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author">
                    <a href="/en/" title="Author" rel="author" class="author"><i class="thibaud-picture-big" aria-hidden="true"></i>Author</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="02/02/2024">02/02/2024</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1903 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;9 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/logo.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/logo.png, /images/hacker-multinationale-via-file-upload-et-ssrf/logo.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/logo.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/logo.png"
        title="Canon, a 20 billion euro multinational corporation, is impacted by 2 critical vulnerabilities that, under certain conditions, can compromise the infrastructure hosting the vulnerable application. Trackflaw shares its discovery and responsible disclosure process." /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#context">Context</a>
      <ul>
        <li><a href="#responsible-disclosure-process">Responsible disclosure process</a></li>
        <li><a href="#the-target">The target</a></li>
      </ul>
    </li>
    <li><a href="#a-routine-penetration-test">A &ldquo;routine&rdquo; penetration test</a>
      <ul>
        <li><a href="#flashback-to-2022">Flashback to 2022</a></li>
        <li><a href="#client-or-not">Client or not?</a></li>
        <li><a href="#cve---common-vulnerabilities-and-exposures">CVE - Common Vulnerabilities and Exposures</a></li>
        <li><a href="#communication-with-anssi">Communication with ANSSI</a></li>
        <li><a href="#responsible-disclosure">Responsible Disclosure</a></li>
        <li><a href="#final-timeline">Final Timeline</a></li>
      </ul>
    </li>
    <li><a href="#the-vulnerabilities">The Vulnerabilities</a>
      <ul>
        <li><a href="#cve-2023-25202-insecure-file-upload-mechanism">CVE-2023-25202: Insecure file upload mechanism</a>
          <ul>
            <li><a href="#description">Description</a></li>
            <li><a href="#exploitation">Exploitation</a></li>
            <li><a href="#risks">Risks</a></li>
            <li><a href="#mitigation">Mitigation</a></li>
          </ul>
        </li>
        <li><a href="#cve-2023-25203-application-vulnerable-to-ssrf-server-side-request-forgery-attacks">CVE-2023-25203: Application Vulnerable to SSRF (Server Side Request Forgery) Attacks</a>
          <ul>
            <li><a href="#description-1">Description</a></li>
            <li><a href="#exploitation-1">Exploitation</a>
              <ul>
                <li><a href="#access-to-a-remote-resource">Access to a Remote Resource</a></li>
                <li><a href="#password-hash-retrieval">Password hash retrieval</a></li>
                <li><a href="#internal-network-mapping">Internal network mapping</a></li>
              </ul>
            </li>
            <li><a href="#risks-1">Risks</a></li>
            <li><a href="#mitigation-1">Mitigation</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#going-further-">Going further !</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="-cve-2023-252023-how-to-hack-multinational-company-with-file-upload-and-ssrf">📸 CVE-2023-2520{2|3}: How to hack MULTINATIONAL company with file upload and SSRF?</h1>
<h2 id="introduction">Introduction</h2>
<p>Information security is now at the <strong>heart of our daily lives</strong>. On the news, on the internet, on social networks, everyone, with or without knowledge, seems to <strong>have already been a victim</strong> of a more or less serious computer attack.</p>
<p>And this can affect small businesses as well as the biggest companies in the <strong>CAC40</strong>. If you thought the security of the world&rsquo;s biggest companies was inviolable, think again.</p>
<p>Some examples of the worst data breaches:</p>
<ul>
<li><strong>Yahoo August 2013</strong>: personal information estimated at up to <strong>3 billion users</strong>.</li>
<li><strong>LinkedIn May 2016</strong>: email/password of more than <strong>150 million users</strong>.</li>
<li><strong>Facebook April 2021</strong>: first name, last name, email, phone, employers of more than <strong>500 million users</strong>.</li>
</ul>
<p>Today, through this article, we&rsquo;ll look back at a hack worth <strong>20 billion euros</strong> (at least! 😅).</p>
<h2 id="context">Context</h2>
<h3 id="responsible-disclosure-process">Responsible disclosure process</h3>
<p>This article was produced in agreement with ANSSI, <a href="https://cyber.gouv.fr/" target="_blank" rel="noopener noreffer ">the National Agency for Information Systems Security</a> following a <strong>responsible disclosure process</strong>.</p>
<div class="details admonition bug open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-bug fa-fw" aria-hidden="true"></i>Be Responsible<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">When discovering a vulnerability, it is preferable to directly contact the developer/responsible party for the solution. <strong>Do not disclose vulnerabilities without authorization.</strong></div>
        </div>
    </div>
<h3 id="the-target">The target</h3>
<p><strong>Canon Inc</strong> is a Japanese company based in Tokyo, specializing in optical products, including cameras, photocopiers, and printers.</p>
<p>It generates a revenue of around <strong>25 billion dollars</strong> annually.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/canon.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/canon.png, /images/hacker-multinationale-via-file-upload-et-ssrf/canon.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/canon.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/canon.png"
        title="Alt text" /></p>
<h2 id="a-routine-penetration-test">A &ldquo;routine&rdquo; penetration test</h2>
<h3 id="flashback-to-2022">Flashback to 2022</h3>
<p>In <strong>December 2022</strong>, Trackflaw was commissioned to perform a technical audit of the web/application penetration test type for a major account client (the name is censored for confidentiality reasons).</p>
<p>The application audit, lasting <strong>5 days</strong>, was to be conducted in a grey box manner and concerned a document management application. This type of audit is quite standard and is regularly performed by Trackflaw.</p>
<p>The audited software was from <strong>Therefore</strong>, a subsidiary of <strong>Canon</strong>. The study of this software revealed <strong>2 critical vulnerabilities</strong>.</p>
<h3 id="client-or-not">Client or not?</h3>
<p><strong>Therefore</strong> is a company offering <strong>information management</strong> solutions. One of the main software products of Therefore specializes in document processing. All solutions are available directly on their website.</p>
<div class="details admonition question open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw" aria-hidden="true"></i>How to Communicate?<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">🤔 So, the discovered vulnerabilities concern <strong>Therefore</strong> and not the initial client. How to communicate the weaknesses?</div>
        </div>
    </div>
<p>💡 Indeed, the question is important!</p>
<p>During the penetration test, several significant vulnerabilities in Therefore&rsquo;s document processing solution were identified.</p>
<p>The penetration test was conducted on <strong>the <code>Capture</code> document management application</strong>. The vulnerabilities concern both the web version and the heavy client version.</p>
<p>Normally, it&rsquo;s the client&rsquo;s responsibility to handle the process:</p>
<ol>
<li>The auditor (Trackflaw) sends the report to the initial client.</li>
<li>The initial client analyzes and sends the report to the developer (Therefore).</li>
<li>The developer (Therefore) fixes the vulnerabilities.</li>
</ol>
<p><video src="/images/hacker-multinationale-via-file-upload-et-ssrf/report.mp4" controls autoplay loop title="Report Communication" style="width:100%"></video></p>
<p>However, here, communication was not&hellip; optimal. The process had to evolve.</p>
<ol>
<li>An initial report concerning all the vulnerabilities from the audit was communicated to the initial client.</li>
<li>A second anonymized report was written containing only the vulnerabilities impacting Therefore (and not the initial client!).</li>
<li>This anonymized report was then to be forwarded to <strong>Therefore</strong>.</li>
</ol>
<p>😅 Except that everything did not go as planned again!</p>
<h3 id="cve---common-vulnerabilities-and-exposures">CVE - Common Vulnerabilities and Exposures</h3>
<p>An IT solution can be used by several actors, or rather, users.</p>
<p>When a weakness is discovered, the researcher must <strong>communicate with the solution&rsquo;s developer</strong> when there is no intermediary client (unlike us here) in order to <strong>fix the problems across all its deployed applications</strong>.</p>
<p>To do this, the researcher will write a small report to explain the discovered problems. This is called an <code>advisory</code>.</p>
<p>To facilitate the traceability of vulnerabilities discovered in &ldquo;public&rdquo; products, the MITRE organization, supported by the United States Department of Homeland Security, created <strong>the CVE information database</strong>.</p>
<div class="details admonition quote open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-quote-right fa-fw" aria-hidden="true"></i>Common Vulnerabilities and Exposures<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><code>Common Vulnerabilities and Exposures</code> or <code>CVE</code> is a public information dictionary related to security vulnerabilities. The database is maintained by the <code>MITRE</code> organization, supported by the United States Department of Homeland Security.</div>
        </div>
    </div>
<p><video src="/images/hacker-multinationale-via-file-upload-et-ssrf/mitre.mp4" controls autoplay loop title="MITRE Database" style="width:100%"></video></p>
<p>In parallel with writing the advisory, <strong>2 declarations</strong> were made concerning the two discovered weaknesses. No technical information is available at this stage. Only the identifiers of the vulnerabilities are available.</p>
<p>In our case, 2 numbers:</p>
<ul>
<li><strong>CVE-2023-25202</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-25202" target="_blank" rel="noopener noreffer ">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-25202</a></li>
<li><strong>CVE-2023-25203</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-25203" target="_blank" rel="noopener noreffer ">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-25203</a></li>
</ul>
<p>The CVE-2023-25202 and CVE-2023-25203 are affected <code>Therefore Case Manager 2018/2021</code> and <code>Therefore Solution Designer 2018/2021</code> (<a href="https://www.therefore.net/help/2021/en-us/rn_releasenotes.html%29" target="_blank" rel="noopener noreffer ">https://www.therefore.net/help/2021/en-us/rn_releasenotes.html)</a>.</p>
<p>All the versions equal or lower at <code>18.4.0</code> and equal or lower at <code>26.1.1</code>  are vulnerable to both vulnerabilities. To this day, I still have no news about Therefore and if the new version is correctly patched.</p>
<h3 id="communication-with-anssi">Communication with ANSSI</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/anssi.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/anssi.png, /images/hacker-multinationale-via-file-upload-et-ssrf/anssi.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/anssi.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/anssi.png"
        title="Alt text" /></p>
<p><strong>ANSSI</strong> or <strong>the French National Agency for the Security of Information Systems</strong> is a French service created by decree in July 2009. This national competency service is attached to the Secretariat-General for National Defence and Security (SGDSN), the authority responsible for assisting the Prime Minister in exercising his responsibilities in terms of defense and national security.</p>
<p>This French organization played a major role in initiating dialogue with <strong>Therefore</strong>.</p>
<h3 id="responsible-disclosure">Responsible Disclosure</h3>
<p>After making contact, ANSSI managed to establish a connection with Therefore via the <strong>Austrian CERT</strong>. This exchange process spanned almost <strong>one year</strong> and unlocked the situation.</p>
<p>After many unreturned messages, ANSSI, in agreement with the Austrian CERT, authorized the disclosure of the vulnerabilities on <strong>December 12, 2023</strong>. 🥳</p>
<h3 id="final-timeline">Final Timeline</h3>
<table>
  <thead>
      <tr>
          <th><strong>Date</strong></th>
          <th><strong>Action</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>November 28, 2022</td>
          <td>Discovery of vulnerabilities during the penetration test</td>
      </tr>
      <tr>
          <td>December 4, 2022</td>
          <td>Communication of vulnerabilities to the initial client</td>
      </tr>
      <tr>
          <td>December 19, 2022</td>
          <td>Writing an advisory for Therefore</td>
      </tr>
      <tr>
          <td>January 16, 2023</td>
          <td>Various unsuccessful contacts with Therefore</td>
      </tr>
      <tr>
          <td>February 28, 2023</td>
          <td>Third and final contact attempt with Therefore</td>
      </tr>
      <tr>
          <td>May 2, 2023</td>
          <td>Contact with ANSSI</td>
      </tr>
      <tr>
          <td>May 9, 2023</td>
          <td>Contact with Therefore via the Austrian CERT</td>
      </tr>
      <tr>
          <td>September 7, 2023</td>
          <td>ANSSI follows up with the Austrian CERT</td>
      </tr>
      <tr>
          <td>December 12, 2023</td>
          <td>Coordinated responsible disclosure with ANSSI and the Austrian CERT (without Therefore&rsquo;s agreement)</td>
      </tr>
  </tbody>
</table>
<h2 id="the-vulnerabilities">The Vulnerabilities</h2>
<h3 id="cve-2023-25202-insecure-file-upload-mechanism">CVE-2023-25202: Insecure file upload mechanism</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25202.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25202.png, /images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25202.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25202.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25202.png"
        title="CVE-2023-25202" /></p>
<div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw" aria-hidden="true"></i>Context<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>The penetration test was conducted in a specific client context without Therefore&rsquo;s support.</p>
<p>The vulnerabilities in this article may only be <strong>applicable in a specific context</strong>.</p>
</div>
        </div>
    </div>
<h4 id="description">Description</h4>
<p>The Therefore application is <strong>too permissive</strong> regarding the type of file that can be uploaded by a user.</p>
<p>Indeed, it only prevents the uploading of <code>HTML</code>, <code>EXE</code>, and <code>BAK</code> files. An attacker can upload technical files such as <code>PHP</code>, <code>ASP</code>, <code>ASPX</code>, and <code>JSP</code> files.</p>
<p>These files could allow, under certain conditions, <strong>the execution of system commands</strong> (not exploitable here).</p>
<p>The image below summarizes the different extensions that can be used in the application (generated with the <code>intruder</code> function of Burp Suite Pro).</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-1.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-1.png, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-1.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-1.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-1.png"
        title="Too many file extensions" /></p>
<h4 id="exploitation">Exploitation</h4>
<p>The application prevents <code>HTML</code> files from being uploaded. This protection can be easily bypassed by uploading <code>markdown (MD)</code> files that support HTML.</p>
<p>It&rsquo;s important to note that it is <strong>not possible to upload executable files</strong> such as malware.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-2.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-2.png, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-2.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-2.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/file-upload-2.png"
        title="Upload of Markdown file containing iframe" /></p>
<p>This lack of control over the uploaded content facilitates the exploitation of the following vulnerability.</p>
<h4 id="risks">Risks</h4>
<p>An attacker is able to upload files not controlled by the application. This allows an attacker to more easily exploit SSRF vulnerabilities, upload malicious files (other than <code>exe</code> type), or trigger denial-of-service attacks.</p>
<p>An attacker could also, under certain conditions, execute code through the uploaded files (ASP, PHP, JSP files, etc).</p>
<h4 id="mitigation">Mitigation</h4>
<p>It is advised to limit the type of files to upload <strong>to the strictly necessary</strong>.</p>
<p>A standard user most of the time needs only text processing files (e.g., office and PDF files) and images. It is recommended to limit the number of usable extensions (refer to the extensions managed by the Aspose plugin developer).</p>
<h3 id="cve-2023-25203-application-vulnerable-to-ssrf-server-side-request-forgery-attacks">CVE-2023-25203: Application Vulnerable to SSRF (Server Side Request Forgery) Attacks</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25203.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25203.png, /images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25203.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25203.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/CVE-2023-25203.png"
        title="CVE-2023-25203" /></p>
<h4 id="description-1">Description</h4>
<p>The <strong>Therefore</strong> solution uses the <code>Aspose</code> software to manage the conversion of uploaded files to PDF format (see screenshot below).</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-1.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-1.png, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-1.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-1.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-1.png"
        title="Version disclosure in PDF metadata." /></p>
<p>Using this type of solution allows the conversion of a large number of different files (more info in Aspose&rsquo;s documentation).</p>
<p>This presents a risk if the application does not properly manage the filtering of unused extensions.</p>
<p>According to the software developer <strong>Aspose</strong>, security measures should be in place to prevent an attacker from making the server execute internal requests. This attack is called <strong>SSRF (Server Side Request Forgery)</strong>.</p>
<p>The solution provided by Therefore is vulnerable to SSRF attacks in several ways.</p>
<h4 id="exploitation-1">Exploitation</h4>
<h5 id="access-to-a-remote-resource">Access to a Remote Resource</h5>
<p>The use of an SVG file illustrates the possibility of making an <code>HTTP GET</code> request by the application to a server controlled by the attacker.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-2.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-2.png, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-2.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-2.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-2.png"
        title="HTTP callback from remote victim application with a malicious SVG file." /></p>
<p>The screenshot above illustrates this SSRF vulnerability using an SVG file (available below).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">svg</span> <span class="na">width</span><span class="o">=</span><span class="s">&#34;500&#34;</span> <span class="na">height</span><span class="o">=</span><span class="s">&#34;500&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="na">xmlns</span><span class="o">=</span><span class="s">&#34;http://www.w3.org/2000/svg&#34;</span> <span class="na">xmlns:xlink</span><span class="o">=</span><span class="s">&#34;http://www.w3.org/1999/xlink&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">image</span> <span class="na">xlink:href</span><span class="o">=</span><span class="s">&#34;http://ATTACKER-IP&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">svg</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="password-hash-retrieval">Password hash retrieval</h5>
<p>In a Windows environment, it is possible to request a resource through a specific path. This functionality can be coupled with this <code>SSRF</code> weakness to <strong>redirect the local account of the machine hosting the application to the attacker&rsquo;s SMB server</strong>.</p>
<p>The latter will receive the <code>NetNTLMv2</code> hash of this service account.</p>
<p>In the screenshot below, an <code>SMB</code> server was deployed on the attacker&rsquo;s machine. By interpreting the SVG file, the attacker&rsquo;s server collects the digest of the machine account <code>FR********4$</code>.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-3.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-3.png, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-3.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-3.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-3.png"
        title="Receiving NetNTLMv2 local machine account digest from the remote server." /></p>
<p>This digest could then be relayed and/or cracked to <strong>attack the initial client&rsquo;s Active Directory environment</strong>.</p>
<h5 id="internal-network-mapping">Internal network mapping</h5>
<p>This SSRF vulnerability also allows an attacker to map the internal architecture of the client (if it communicates with the Internet).</p>
<p>In the screenshot below, it is possible to reach the server <code>google.fr</code>. The attacker could also use the victim machine as a proxy to <strong>impersonate its public IP address</strong>.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-4.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-4.png, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-4.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-4.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-4.png"
        title="Iframe google.fr" /></p>
<p>Finally, an attacker is also able to perform the following actions (not conclusive due to lack of time):</p>
<ul>
<li><strong>Port Scanning</strong>: it is possible to scan the ports of machines on the network.</li>
<li><strong>File Reading</strong>: the Aspose plugin seems to be protected against file reading (e.g., the screenshot below. The service redirects to loading the file <code>C:\Windows\win.ini</code> but nothing is displayed).</li>
<li><strong>Denial of Service</strong>: an attacker is able to upload a document referring to very large images. When processing this image, the library consumes memory and time to process these images.</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-5.png"
        data-srcset="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-5.png, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-5.png 1.5x, /images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-5.png 2x"
        data-sizes="auto"
        alt="/images/hacker-multinationale-via-file-upload-et-ssrf/screens/ssrf-5.png"
        title="No file disclosure with server redirection" /></p>
<h4 id="risks-1">Risks</h4>
<p>The main risks of this vulnerability for clients using this solution are:</p>
<ul>
<li><strong>Credential Theft</strong>: an attacker is able to collect the <code>NetNTLMv2</code> digest of a person uploading remote content. This type of challenge can be cracked by the attacker to retrieve the target user&rsquo;s password.</li>
<li><strong>Disclosure of Sensitive Images</strong>: processing a document containing a reference to a local image file will result in the disclosure of this file in the final document. This can lead to the disclosure of sensitive information.</li>
<li><strong>Mapping the Victim&rsquo;s Information System</strong>: an attacker can map the victim&rsquo;s infrastructure and perform service discovery.</li>
<li><strong>Denial of Service</strong>: an attacker can prevent the machine from functioning properly by rendering it unusable.</li>
</ul>
<h4 id="mitigation-1">Mitigation</h4>
<p>To mitigate this SSRF vulnerability, it is possible to modify the configuration of the <code>Aspose</code> plugin used in the file analysis function. The plugin is able to prevent SSRF attacks.</p>
<p><strong>Aspose</strong> has already published an article warning about the various risks associated with loading remote elements.</p>
<p>The following code example shows how to disable the loading of external images:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">DisableExternalImagesHandler</span> <span class="p">:</span> <span class="n">IResourceLoadingCallback</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ResourceLoadingAction</span> <span class="n">ResourceLoading</span><span class="p">(</span><span class="n">ResourceLoadingArgs</span> <span class="n">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Skip external images loading.</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">ResourceType</span> <span class="p">==</span> <span class="n">ResourceType</span><span class="p">.</span><span class="n">Image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">?</span> <span class="n">ResourceLoadingAction</span><span class="p">.</span><span class="n">Skip</span>
</span></span><span class="line"><span class="cl">        <span class="p">:</span> <span class="n">ResourceLoadingAction</span><span class="p">.</span><span class="n">Default</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="kt">string</span> <span class="n">documentFilename</span> <span class="p">=</span> <span class="s">&#34;input.docx&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">disableExternalImagesOptions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">LoadOptions</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ResourceLoadingCallback</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DisableExternalImagesHandler</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">doc</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Document</span><span class="p">(</span><span class="n">documentFilename</span><span class="p">,</span> <span class="n">disableExternalImagesOptions</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="going-further-">Going further !</h2>
<p>Whew! A lot of information! 😅</p>
<p>👇 A video is available on Trackflaw&rsquo;s channel for better simplification. Feel free to leave your feedback in the comments 🙏</p>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube-nocookie.com/embed/TnIGum11HnY?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 02/02/2024</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/en/multinational-hacking-with-file-upload-and-ssrf/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://trackflaw.com/en/multinational-hacking-with-file-upload-and-ssrf/" data-title="How to Hack a 20 billion euro multinational corporation (legally)?" data-via="trackflaw" data-hashtags="Penetration Testing,Pentest,CVE"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://trackflaw.com/en/multinational-hacking-with-file-upload-and-ssrf/" data-hashtag="Penetration Testing"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://trackflaw.com/en/multinational-hacking-with-file-upload-and-ssrf/" data-title="How to Hack a 20 billion euro multinational corporation (legally)?"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://trackflaw.com/en/multinational-hacking-with-file-upload-and-ssrf/" data-title="How to Hack a 20 billion euro multinational corporation (legally)?"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://trackflaw.com/en/multinational-hacking-with-file-upload-and-ssrf/" data-title="How to Hack a 20 billion euro multinational corporation (legally)?" data-image="/images/hacker-multinationale-via-file-upload-et-ssrf/logo.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/en/tags/penetration-testing/">Penetration Testing</a>,&nbsp;<a href="/en/tags/pentest/">Pentest</a>,&nbsp;<a href="/en/tags/cve/">CVE</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/en/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/en/compromise-jenkins-reading-files-cve-2024-23897/" class="prev" rel="prev" title="Compromise Jenkins reading files CVE-2024-23897"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Compromise Jenkins reading files CVE-2024-23897</a>
            <a href="/en/ghostrace-new-concern-cpu-vulnerability/" class="next" rel="next" title="GhostRace: New concern CPU vulnerability">GhostRace: New concern CPU vulnerability<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Trackflaw</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.fr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/en/index.json","lunrLanguageCode":"en","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TRE4WGVY4F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TRE4WGVY4F');
</script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-TRE4WGVY4', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-TRE4WGVY4" async></script></body>
</html>
